#!/bin/bash

temp_dir=$(mktemp -d)
cd "${temp_dir}"

cleanup() {
    rm -rf -- "${temp_dir}"
}
trap cleanup EXIT

TIMEFORMAT='%U'

case "$(uname)" in
  Linux) grep '^model name' /proc/cpuinfo -m 1 ;;
  Darwin) sysctl -n machdep.cpu.brand_string ;;
esac

for i in {0..6}; do
  rounds=$((16*(2**i)))
  time_in_seconds=$(exec 2>&1 >/dev/null; time ssh-keygen -t ed25519 -f $rounds -N 'passphrase' -a $rounds)
  printf '%4d %s\n' $rounds $time_in_seconds
done
